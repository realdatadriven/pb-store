{{ define "content" }}
<div class="min-h-screen bg-white">
	<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
		<h1 class="text-3xl font-bold text-gray-900 mb-8">Shopping Cart</h1>
		
		<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
			<!-- Cart Items -->
			<div class="lg:col-span-2">
				<div id="cart-items">
					<!-- Cart items will be populated by JavaScript -->
					<div id="empty-cart" class="text-center py-16">
						<div class="text-gray-400 mb-4">
							<svg class="w-16 h-16 mx-auto" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 3h2l.4 2M7 13h10l4-8H5.4m0 0L7 13m0 0l-1.5 6M7 13l-1.5 6m0 0h9m-9 0h9"></path>
							</svg>
						</div>
						<h3 class="text-lg font-medium text-gray-900 mb-2">Your cart is empty</h3>
						<p class="text-gray-500 mb-4">Add some products to get started!</p>
						<a href="/" class="bg-black text-white px-6 py-3 rounded-md hover:bg-gray-800 transition-colors">
							Continue Shopping
						</a>
					</div>
				</div>
			</div>

			<!-- Order Summary -->
			<div class="lg:col-span-1">
				<div class="bg-gray-50 rounded-lg p-6" id="cart-summary" style="display: none;">
					<h2 class="text-lg font-medium text-gray-900 mb-4">Order Summary</h2>
					
					<div class="space-y-3">
						<div class="flex justify-between">
							<span class="text-gray-600">Subtotal</span>
							<span class="font-medium" id="cart-subtotal">€0.00</span>
						</div>
						<div class="flex justify-between">
							<span class="text-gray-600">Shipping</span>
							<span class="font-medium" id="cart-shipping">€4.95</span>
						</div>
						<div class="border-t pt-3">
							<div class="flex justify-between">
								<span class="text-lg font-medium text-gray-900">Total</span>
								<span class="text-lg font-medium text-gray-900" id="cart-total">€0.00</span>
							</div>
						</div>
					</div>

					<button class="w-full bg-black text-white py-3 px-4 rounded-md hover:bg-gray-800 transition-colors mt-6" onclick="proceedToCheckout()">
						Proceed to Checkout
					</button>
				</div>
			</div>
		</div>
	</div>
</div>

<script>
// Cart functionality
let cart = JSON.parse(localStorage.getItem('cart') || '[]');

function updateCartDisplay() {
	const cartItems = document.getElementById('cart-items');
	const emptyCart = document.getElementById('empty-cart');
	const cartSummary = document.getElementById('cart-summary');
	const cartCount = document.getElementById('cart-count');
	
	if (cart.length === 0) {
		emptyCart.style.display = 'block';
		cartSummary.style.display = 'none';
		if (cartCount) cartCount.textContent = '0';
		return;
	}

	emptyCart.style.display = 'none';
	cartSummary.style.display = 'block';
	
	let html = '';
	let subtotal = 0;
	
	cart.forEach((item, index) => {
		const itemTotal = item.price * item.quantity;
		subtotal += itemTotal;
		
		html += `
			<div class="flex items-center py-6 border-b border-gray-200">
				<div class="flex-shrink-0 w-24 h-24 bg-gray-100 rounded-lg overflow-hidden">
					${item.image ? 
						`<img src="${item.image}" alt="${item.title}" class="w-full h-full object-cover">` :
						`<div class="w-full h-full flex items-center justify-center text-gray-400">
							<svg class="w-8 h-8" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"></path>
							</svg>
						</div>`
					}
				</div>
				<div class="ml-6 flex-1">
					<h3 class="text-lg font-medium text-gray-900">${item.title}</h3>
					<p class="text-gray-600 mt-1">${item.currency || '€'}${item.price.toFixed(2)}</p>
					<div class="flex items-center mt-3">
						<button onclick="updateQuantity(${index}, ${item.quantity - 1})" class="w-8 h-8 rounded-md border border-gray-300 flex items-center justify-center hover:bg-gray-50">
							<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M20 12H4"></path>
							</svg>
						</button>
						<span class="mx-3 text-gray-900">${item.quantity}</span>
						<button onclick="updateQuantity(${index}, ${item.quantity + 1})" class="w-8 h-8 rounded-md border border-gray-300 flex items-center justify-center hover:bg-gray-50">
							<svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
								<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
							</svg>
						</button>
					</div>
				</div>
				<div class="ml-6 flex flex-col items-end">
					<p class="text-lg font-medium text-gray-900">${item.currency || '€'}${itemTotal.toFixed(2)}</p>
					<button onclick="removeFromCart(${index})" class="text-red-600 hover:text-red-800 mt-2">
						<svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
							<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"></path>
						</svg>
					</button>
				</div>
			</div>
		`;
	});
	
	cartItems.innerHTML = html;
	
	// Update summary
	const shipping = subtotal > 50 ? 0 : 4.95;
	const total = subtotal + shipping;
	
	document.getElementById('cart-subtotal').textContent = `€${subtotal.toFixed(2)}`;
	document.getElementById('cart-shipping').textContent = shipping === 0 ? 'Free' : `€${shipping.toFixed(2)}`;
	document.getElementById('cart-total').textContent = `€${total.toFixed(2)}`;
	
	// Update cart count in header
	if (cartCount) cartCount.textContent = cart.reduce((sum, item) => sum + item.quantity, 0);
}

function updateQuantity(index, newQuantity) {
	if (newQuantity <= 0) {
		removeFromCart(index);
		return;
	}
	
	cart[index].quantity = newQuantity;
	localStorage.setItem('cart', JSON.stringify(cart));
	updateCartDisplay();
}

function removeFromCart(index) {
	cart.splice(index, 1);
	localStorage.setItem('cart', JSON.stringify(cart));
	updateCartDisplay();
}

function proceedToCheckout() {
	if (cart.length === 0) {
		alert('Your cart is empty!');
		return;
	}
	window.location.href = '/checkout';
}

// Initialize cart display
updateCartDisplay();
</script>
{{ end }}
{{ template "store" . }}

